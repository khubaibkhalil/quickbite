YUI.add("hermes-template-flag-photo-dialog-content",(function(n,e){var l=n.Template.Handlebars.revive({1:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return null!=(o=r(l,"if").call(null!=e?e:n.nullContext||{},null!=e?r(e,"fallsWithinSettings"):e,{name:"if",hash:{},fn:n.program(2,a,0),inverse:n.program(4,a,0),data:a,loc:{start:{line:2,column:1},end:{line:6,column:8}}}))?o:""},2:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(l,"intlHTMLMessage")||e&&o(e,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.FLAG_CONFIRMATION_SAFE_WITHIN"},data:a,loc:{start:{line:3,column:2},end:{line:3,column:81}}}))+"\n"},4:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(l,"intlHTMLMessage")||e&&o(e,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.FLAG_CONFIRMATION_SAFE_OUTSIDE"},data:a,loc:{start:{line:5,column:2},end:{line:5,column:82}}}))+"\n"},6:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return null!=(o=r(l,"if").call(null!=e?e:n.nullContext||{},null!=e?r(e,"fallsWithinSettings"):e,{name:"if",hash:{},fn:n.program(7,a,0),inverse:n.program(9,a,0),data:a,loc:{start:{line:10,column:1},end:{line:14,column:8}}}))?o:""},7:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(l,"intlHTMLMessage")||e&&o(e,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.FLAG_CONFIRMATION_MODERATE_WITHIN"},data:a,loc:{start:{line:11,column:2},end:{line:11,column:85}}}))+"\n"},9:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(l,"intlHTMLMessage")||e&&o(e,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.FLAG_CONFIRMATION_MODERATE_OUTSIDE"},data:a,loc:{start:{line:13,column:2},end:{line:13,column:86}}}))+"\n"},11:function(n,e,l,t,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return null!=(o=r(l,"if").call(null!=e?e:n.nullContext||{},null!=e?r(e,"fallsWithinSettings"):e,{name:"if",hash:{},fn:n.program(12,a,0),inverse:n.program(14,a,0),data:a,loc:{start:{line:18,column:1},end:{line:22,column:8}}}))?o:""},12:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(l,"intlHTMLMessage")||e&&o(e,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.FLAG_CONFIRMATION_RESTRICTED_WITHIN"},data:a,loc:{start:{line:19,column:2},end:{line:19,column:87}}}))+"\n"},14:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(l,"intlHTMLMessage")||e&&o(e,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.FLAG_CONFIRMATION_RESTRICTED_OUTSIDE"},data:a,loc:{start:{line:21,column:2},end:{line:21,column:88}}}))+"\n"},compiler:[8,">= 4.3.0"],main:function(n,e,l,t,a){var o,r=null!=e?e:n.nullContext||{},s=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return(null!=(o=s(l,"if").call(r,null!=e?s(e,"isSafe"):e,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:1,column:0},end:{line:7,column:7}}}))?o:"")+"\n"+(null!=(o=s(l,"if").call(r,null!=e?s(e,"isModerate"):e,{name:"if",hash:{},fn:n.program(6,a,0),inverse:n.noop,data:a,loc:{start:{line:9,column:0},end:{line:15,column:7}}}))?o:"")+"\n"+(null!=(o=s(l,"if").call(r,null!=e?s(e,"isRestricted"):e,{name:"if",hash:{},fn:n.program(11,a,0),inverse:n.noop,data:a,loc:{start:{line:17,column:0},end:{line:23,column:7}}}))?o:"")+"\n"+n.escapeExpression((s(l,"intlHTMLMessage")||e&&s(e,"intlHTMLMessage")||n.hooks.helperMissing).call(r,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.FOR_MORE_INFORMATION_SAFESEARCH"},data:a,loc:{start:{line:25,column:0},end:{line:25,column:81}}}))},useData:!0}),t={};n.Array.each([],(function(e){var l=n.Template.get("hermes/"+e);l&&(t[e]=l)})),n.Template.register("hermes/flag-photo-dialog-content",(function(e,a){return(a=a||{}).partials=a.partials?n.merge(t,a.partials):t,l(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("sub-photo-additional-info-view",(function(e,t){var i=require("hermes-core/flog")(t),n={working:"working",apiError:"api-error",ready:"ready"},s=0,o=1,a=2;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.backToURL=e.backToURL,this.isModerated=e.isModerated,this.isMobile=e.isMobile,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.privacyPermissionsMenuItems=[{value:"public",text:this.intlMessage({intlName:"settings.PUBLIC"})},{value:"private",text:this.intlMessage({intlName:"settings.PRIVATE"})},{value:"friends",text:this.intlMessage({intlName:"settings.FRIENDS"})},{value:"family",text:this.intlMessage({intlName:"settings.FAMILY"})},{value:"friendsandfamily",text:this.intlMessage({intlName:"settings.FRIENDS_AND_FAMILY"})}],this.printPermissionMenuItems=[{value:0,text:this.intlMessage({intlName:"settings.ONLY_YOU"})},{value:1,text:this.intlMessage({intlName:"settings.FRIENDS"})},{value:2,text:this.intlMessage({intlName:"settings.FAMILY"})},{value:3,text:this.intlMessage({intlName:"settings.FRIENDS_AND_FAMILY"})},{value:4,text:this.intlMessage({intlName:"settings.PEOPLE_YOU_FOLLOW"})},{value:5,text:this.intlMessage({intlName:"settings.ANY_FLICKR_MEMBER"})},{value:6,text:this.intlMessage({intlName:"settings.PUBLIC"})}],this.commentingPermissionsMenuItems=[{value:0,text:this.intlMessage({intlName:"settings.ONLY_YOU"})},{value:1,text:this.intlMessage({intlName:"settings.FRIENDS_AND_FAMILY"})},{value:2,text:this.intlMessage({intlName:"settings.PEOPLE_YOU_FOLLOW"})},{value:3,text:this.intlMessage({intlName:"settings.ANY_FLICKR_MEMBER"})}],this.metaPermissionsMenuItems=[{value:0,text:this.intlMessage({intlName:"settings.ONLY_YOU"})},{value:1,text:this.intlMessage({intlName:"settings.FRIENDS_AND_FAMILY"})},{value:2,text:this.intlMessage({intlName:"settings.PEOPLE_YOU_FOLLOW"})},{value:3,text:this.intlMessage({intlName:"settings.ANY_FLICKR_MEMBER"})}],this.videoContentTypeMenuItems=[{value:0,text:this.intlMessage({intlName:"common.VIDEO"})},{value:1,text:this.intlMessage({intlName:"common.SCREENCAST"})},{value:2,text:this.intlMessage({intlName:"common.ANIMATION_CGI"})},{value:3,text:this.intlMessage({intlName:"common.MACHINIMA"})}],this.photoContentTypeMenuItems=[{value:0,text:this.intlMessage({intlName:"common.PHOTO"})},{value:1,text:this.intlMessage({intlName:"common.SCREENSHOT"})},{value:2,text:this.intlMessage({intlName:"common.ILLUSTRATION_ART"})},{value:3,text:this.intlMessage({intlName:"common.VIRTUAL_PHOTOGRAPHY"})}],this.safetyLevelMenuItems=[{value:s,text:this.intlMessage({intlName:"settings.SAFE"})},{value:o,text:this.intlMessage({intlName:"settings.MODERATE"})},{value:a,text:this.intlMessage({intlName:"settings.RESTRICTED"})}],this},subviewConfig:{"photo-license-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){var t=this,i=this.appContext.getViewer(),n={};return n.photo=this.appContext.getModel("photo-models",this.photoId),n.privacy=this.appContext.getModel("photo-privacy-models",this.photoId),i.signedIn&&(n.personPreferences=this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid),n.privileges=this.appContext.getModel("privileges-models",i.nsid)),new e.FlickrPromise(n).then((function(e){t.set("photo",e.photo),t.set("privacy",e.privacy),e.personPreferences&&t.set("personPreferences",e.personPreferences),e.privileges&&t.set("privileges",e.privileges)}))},buildContainer:function(){var t,i=this.get("photo"),n=this.get("privileges"),o=this.get("privacy").toJSON(),a=i.getValue("owner").getValue("isMe"),r=!a&&this.appContext.getViewer().signedIn,l=!this.appContext.flipper.isFlipped("enable-scrappy-notes"),c=a,m=!1,p=!1;let h=i.getPhotoLicenseInformation();a&&i.getValue("isVideo")&&(i.getValue("isVideoPending")||i.getValue("isVideoFailed"))&&(c=!1,m=i.getValue("isVideoPending"),p=i.getValue("isVideoFailed"));var u=this.commentingPermissionsMenuItems.find((e=>e.value===this.get("privacy").getValue("permComment")));u=u?u.text:"---";var d=this.privacyPermissionsMenuItems.find((t=>t.value===e.PrivacyHelper.mapPrivacy(o)));d=d?d.text:"---";var g=this.metaPermissionsMenuItems.find((e=>e.value===this.get("privacy").getValue("permAddMeta")));g=g?g.text:"---";var v,f=this.printPermissionMenuItems.find((e=>e.value===o.permPrint));f=f?f.text:"---",v=i.getValue("isVideo")?(v=this.videoContentTypeMenuItems.find((e=>e.value===i.getValue("contentType"))))?v.text:"---":(v=this.photoContentTypeMenuItems.find((e=>e.value===i.getValue("contentType"))))?v.text:"---";var C=this.safetyLevelMenuItems.find((e=>e.value===i.getValue("safetyLevel")));return C=C?C.text:"---",n&&(n.getValue("privileges").canSetNonSafe||(this.safetyLevelMenuItems[1].disabled=!0,this.safetyLevelMenuItems[2].disabled=!0,i.getValue("safetyLevel")!==s&&(this.safetyLevelMenuItems[0].disabled=!0))),t={safetyLevel:i.getValue("safetyLevel"),privacy:o,commentingPermission:o.permComment,addMetaPermission:o.permAddMeta,printPermission:o.permPrint,privacySelected:e.PrivacyHelper.mapPrivacy(o).toLowerCase(),contentType:i.getValue("contentType"),privacyIsEditable:c,wasModerated:this.isModerated&&i.getValue("systemModerated"),commentingIsEditable:a,metadataIsEditable:a,printIsEditable:a&&!i.getValue("isVideo"),safetyIsEditable:a,contentTypeIsEditable:a,isVideo:i.getValue("isVideo"),videoIsPending:m,videoHasFailed:p,showFlagPhoto:r,showFeedback:l,commentingLevel:u,privacyLevel:d,metaLevel:g,selectedSafetyLevel:C,printLevel:f,selectedContentType:v,licenseType:h?this.intlMessage({intlName:h.key}):null,licenseUrl:h?h.url:null,shouldSeeSidebar:this.appContext.adManager.userCanViewPhotoPageSidebar()&&!this.isMobile},this.setContainerWithTemplate("sub-photo-additional-info",t),this},activate:function(){var t=this,i=this.get("photo"),n=this.get("privacy"),s=(i.getValue("owner").getValue("isMe"),this.get("container")),o=s.one(".moderation-tooltip"),a=s.one(".flag-photo");n&&this.registerEventHandler(n.on("valuesChanged",(function(i){var o=e.PrivacyHelper.mapPrivacy(n.toJSON());s.one(".c-charm-item-privacy i").hasClass("ui-icon-tiny-privacy"+o.toLowerCase())||t.privacyDd.select(o)}))),o&&this.registerEventHandler(o.on("click",this.handleModerationTooltipClick.bind(this))),a&&this.registerEventHandler(a.on("click",this.handleFlagPhotoClick,this));var r=s.one(".privacy-permissions-button"),l=s.one(".commenting-button"),c=s.one(".meta-permissions-button"),m=s.one(".safety-level-button"),p=s.one(".content-type-button");if(r&&this.registerEventHandler(r.on("click",this.handlePrivacyClick.bind(this))),l&&this.registerEventHandler(l.on("click",this.handleCommentingPermissionsClick.bind(this))),c&&this.registerEventHandler(c.on("click",this.handleMetadataPermissionsClick.bind(this))),m&&this.registerEventHandler(m.on("click",this.handleSafetyLevelClick.bind(this))),p&&this.registerEventHandler(p.on("click",this.handleContentTypeClick.bind(this))),this.get("photo")&&this.registerEventHandler(this.get("photo").on("valuesChanged",(function(t){t.license&&e.fire("licenseHistory:licenseUpdated")}))),this.appContext.flipper.isFlipped("enable-license-history-modal")&&s.all(".show-license-history").each((function(e){e.on("click",function(e){e.preventDefault(),this.showLicenseHistoryModal()}.bind(this))}),this),this.appContext.flipper.isFlipped("enable-others-to-print")){var h=s.one(".print-permissions-button");h&&this.registerEventHandler(h.on("click",this.handlePrintPermissionsClick.bind(this)))}return this},setSafetyLevel:function(e){var t=this.get("photo"),s=t.getValue("safetyLevel"),o=this.get("container").one(".c-charm-item-safetylevel"),a=this.get("container").one(".c-charm-item-safetylevel i"),r=this.get("container").one(".moderation-tooltip");e!==s&&r&&r.setStyle("display","none"),t.setValue("safetyLevel",e),a.replaceClass("ui-icon-tiny-safety-"+s,"ui-icon-tiny-safety-"+e),o&&(o.addClass(n.working),o.removeClass(n.apiError)),"restricted"===e?this.fire("subviewViewEvent","disable-sharing"):this.fire("subviewViewEvent","enable-sharing"),t.remoteUpdate().then((()=>{o&&o.removeClass(n.working)}),(r=>{t.setValue("safetyLevel",s);var l=this.safetyLevelMenuItems.find((e=>e.value===s));this.get("container").one(".safety-level-text").set("text",l.text),a.replaceClass("ui-icon-tiny-safety-"+e,"ui-icon-tiny-safety-"+s),o&&(o.removeClass(n.working),o.addClass(n.apiError)),this.onError(this.intlMessage({intlName:"photo-page-scrappy.SAFETY_CHANGE_ERROR"})),i.error({err:r})}))},changingToStricterPrivacy:function(t){var i=this.get("privacy"),n=e.PrivacyHelper.mapPrivacy(i.toJSON());return t!==n&&("private"===t||"public"===n||"family"===t&&"friends"===n||"friends"===t&&"family"===n||"friends"===t&&"friendsandfamily"===n||"family"===t&&"friendsandfamily"===n)},setPrivacy:function(t){var i=this.get("privacy"),n=!1,s=this;!s.stricterPrivacyChangeWarningDialog&&s.changingToStricterPrivacy(t)?(n=!0,s.stricterPrivacyChangeWarningDialog=new e.Views.FluidModal({appContext:s.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!0,title:s.intlMessage({intlName:"photo-page-scrappy.STRICTER_PRIVACY_CHANGE_DIALOG_TITLE"}),actionButtonLabel:s.intlMessage({intlName:"common.OK"}),cancelButtonLabel:s.intlMessage({intlName:"common.CANCEL"}),htmlMessage:s.intlMessage({intlName:"photo-page-scrappy.STRICTER_PRIVACY_CHANGE_DIALOG_MESSAGE"})}),s.stricterPrivacyChangeWarningDialog.on("actionClick",(function(e){s.changePrivacy(t,n)})),s.stricterPrivacyChangeWarningDialog.on("cancelClick",(function(t){s.stricterPrivacyChangeWarningDialog=void 0;var n=s.privacyPermissionsMenuItems.find((t=>t.value===e.PrivacyHelper.mapPrivacy(i.toJSON())));s.get("container").one(".privacy-text").set("text",n.text)})),s.stricterPrivacyChangeWarningDialog.show()):s.changePrivacy(t,n)},changePrivacy:function(t,s){var o=this.get("privacy"),a=this.get("container").one(".c-charm-item-privacy"),r=e.PrivacyHelper.mapPrivacy(t),l=(e.PrivacyHelper.mapPrivacy(o.toJSON()),this.get("container").one(".c-charm-item-privacy i")),c=this;l.replaceClass(l.getDOMNode().className,"ui-icon-tiny-privacy"+t.toLowerCase()),a&&(a.removeClass(n.apiError),a.addClass(n.working)),Object.keys(r).forEach((function(e){o.setValue(e,r[e])})),o.remoteUpdate().then((function(){a&&(a.removeClass(n.working),a.removeClass(n.apiError)),s?(window.scrollTo(0,0),e.config.win.location.reload()):c.appContext.getModelRegistry("photostream-models").then((function(e){e.removeAll()}))}),(function(t){Object.keys(r).forEach((function(e){o.revertValue(e)})),a&&(a.removeClass(n.working),a.addClass(n.apiError),e.config.win.setTimeout((function(){a&&a.addClass(n.apiError)}),100)),e.PrivacyHelper.mapPrivacy(o.toJSON()),c.onError(c.intlMessage({intlName:"photo-page-scrappy.PRIVACY_CHANGE_ERROR"})),i.error({err:t})}))},setCommentingPermission:function(e){var t=this.get("privacy"),s=t.getValue("permComment"),o=this.get("container").one(".commenting-permission"),a=this.get("container").one(".ui-icon-tiny-commentPermission"+s);t.setValue("permComment",e),a.replaceClass("ui-icon-tiny-commentPermission"+s,"ui-icon-tiny-commentPermission"+e),o&&(o.addClass(n.working),o.removeClass(n.apiError)),t.remoteUpdate().then((()=>{o&&o.removeClass(n.working)}),(r=>{t.setValue("permComment",s);var l=this.commentingPermissionsMenuItems.find((e=>e.value===this.get("privacy").getValue("permComment")));this.get("container").one(".commenting-permission-text").set("text",l.text),a.replaceClass("ui-icon-tiny-commentPermission"+e,"ui-icon-tiny-commentPermission"+s),o&&(o.removeClass(n.working),o.addClass(n.apiError)),this.onError(this.intlMessage({intlName:"photo-page-scrappy.COMMENT_PERMS_UPDATE_ERROR"})),i.error({err:r})}))},setAddMetaPermission:function(e){var t=this.get("privacy"),s=t.getValue("permAddMeta"),o=this.get("container").one(".add-meta-permission"),a=this.get("container").one(".ui-icon-tiny-metaPermission"+s);t.setValue("permAddMeta",e),a.replaceClass("ui-icon-tiny-metaPermission"+s,"ui-icon-tiny-metaPermission"+e),o&&(o.addClass(n.working),o.removeClass(n.apiError)),t.remoteUpdate().then((()=>{o&&o.removeClass(n.working)}),(r=>{t.setValue("permAddMeta",s);var l=this.metaPermissionsMenuItems.find((e=>e.value===s));this.get("container").one(".meta-permissions-text").set("text",l.text),a.replaceClass("ui-icon-tiny-metaPermission"+e,"ui-icon-tiny-metaPermission"+s),o&&(o.removeClass(n.working),o.addClass(n.apiError)),this.onError(this.intlMessage({intlName:"photo-page-scrappy.META_PERMS_UPDATE_ERROR"})),i.error({err:r})}))},setPrintPermission:function(e){var t=this.get("privacy"),s=t.getValue("permPrint"),o=this.get("container").one(".print-permission"),a=this.get("container").one(".ui-icon-tiny-printPermission"+s);t.setValue("permPrint",e),a.replaceClass("ui-icon-tiny-printPermission"+s,"ui-icon-tiny-printPermission"+e),o&&(o.addClass(n.working),o.removeClass(n.apiError),o.removeClass(n.ready)),t.remoteUpdate().then((()=>{o&&(o.removeClass(n.working),o.addClass(n.ready))}),(r=>{t.setValue("permPrint",s);var l=this.printPermissionMenuItems.find((e=>e.value===s));this.get("container").one(".print-permissions-text").set("text",l.text),a.replaceClass("ui-icon-tiny-printPermission"+e,"ui-icon-tiny-printPermission"+s),o&&(o.removeClass(n.working),o.removeClass(n.ready),o.addClass(n.apiError)),this.onError(this.intlMessage({intlName:"photo-page-scrappy.META_PERMS_UPDATE_ERROR"})),i.error({err:r})}))},setContentType:function(e){var t=this.get("photo"),s=t.getValue("contentType"),o=this.get("container").one(".content-type");t.setValue("contentType",e),o&&(o.addClass(n.working),o.removeClass(n.apiError)),t.remoteUpdate().then((()=>{o&&o.removeClass(n.working)}),(e=>{var a;t.setValue("contentType",s),a=t.getValue("isVideo")?this.videoContentTypeMenuItems.find((e=>e.value===s)):this.photoContentTypeMenuItems.find((e=>e.value===s)),this.get("container").one(".content-type-text").set("text",a.text),o&&(o.removeClass(n.working),o.addClass(n.apiError)),this.onError(this.intlMessage({intlName:"common.ERROR"})),i.error({err:e})}))},handleFlagPhotoClick:function(t){t.preventDefault();this.get("photo").getValue("safetyLevel"),this.get("personPreferences").getValue("safeSearch");var i,n=e.url(this.get("photo").getValue("url"));i=new e.Views.FlagModal({appContext:this.appContext,contentUrl:n,flagPhotoContainer:this.get("container").one(".flag-photo")}),new e.Views.FluidModal({appContext:this.appContext,subview:i,dismissOnOverlayClick:!0,showHeader:!1,showFooter:!1,showButtons:!1,showCancelButton:!1,showActionButton:!1,showCancelX:!1,contentPadding:0}).show()},handleModerationTooltipClick:function(t){var i=this,n=i.get("container").one(".moderation-tooltip");new e.Views.FluidDroparound({appContext:i.appContext,htmlMessage:i.intlHTMLMessage({intlName:"photo-page-scrappy.AUTO_MODERATION_MESSAGE",learnUrl:"https://flickrhelp.com/hc/en-us/articles/4404064374164-Set-the-Safety-Levels-of-Your-Flickr-Content-or-Account"}),showDropArrow:!0,dismissOnOverlayClick:!0,anchorElement:n,keyboardAnchorElement:n}).show()},handleFlagPhotoConfirmClick:function(e){var t=this;t.appContext.callAPI("flickr.moderation.flagPhoto",{photo_id:this.photoId,offensive:1}).then((function(e){t.get("container").one(".flag-photo").replace(t.intlMessage({intlName:"more-menu-view.PHOTO_HAS_BEEN_FLAGGED"}))}),(function(e){t.onError(t.intlMessage({intlName:"more-menu-view.PROBLEM_FLAGGING"}))}))},showLicenseHistoryModal:function(){new e.Views.FluidModal({showHeader:!0,appContext:this.appContext,dismissOnOverlayClick:!0,showActionButton:!0,showCancelButton:!1,actionButtonLabel:this.intlMessage({intlName:"common.CLOSE"}),title:this.intlMessage({intlName:"photo-page-scrappy.SHOW_LICENSE_HISTORY_CTA"}),extra:this.intlMessage({intlName:"photo-page-scrappy.LICENSE_HISTORY_DATE",firstLicenseDate:new Date("Tue Jul 17 2008 12:00:00 GMT-0800 (Pacific Standard Time)")}),width:560,height:400,showBodyLines:!0,showButtons:!0,showFooter:!0,showCancelX:!0,classList:"license-history",subview:new e.Views["license-history-view"]({photoId:this.photoId})}).show().on("activated",(function(){e.fire("licenseHistoryModal:activate")}))},handlePrivacyClick:function(){var t=this,i=t.privacyPermissionsMenuItems,n=t.get("privacy").toJSON();i.forEach((function(t){t.value===e.PrivacyHelper.mapPrivacy(n)?t.isSelected=!0:t.isSelected=!1}));var s=new e.Views.FluidDroparound({appContext:this.appContext,preferBottom:!0,popBeforePushOther:!0,classList:"sub-photo-additional-info-droparound",anchorElement:this.get("container").one(".privacy-permissions-button").one(".arrow"),menuItems:i});s.show(),this.registerEventHandler(s.on("selected",(function(e){e&&e.menuItem&&(t.get("container").one(".privacy-text").set("text",e.menuItem.text),t.setPrivacy(e.menuItem.value)),s.close()})),this)},handleCommentingPermissionsClick:function(){var t=this,i=this.commentingPermissionsMenuItems;i.forEach((function(e){e.value===t.get("privacy").getValue("permComment")?e.isSelected=!0:e.isSelected=!1}));var n=new e.Views.FluidDroparound({appContext:this.appContext,preferBottom:!0,popBeforePushOther:!0,classList:"sub-photo-additional-info-droparound",anchorElement:this.get("container").one(".commenting-button").one(".arrow"),menuItems:i});n.show(),this.registerEventHandler(n.on("selected",(function(e){e&&e.menuItem&&(t.get("container").one(".commenting-permission-text").set("text",e.menuItem.text),t.setCommentingPermission(e.menuItem.value)),n.close()})),this)},handleMetadataPermissionsClick:function(){var t=this,i=this.metaPermissionsMenuItems;i.forEach((function(e){e.value===t.get("privacy").getValue("permAddMeta")?e.isSelected=!0:e.isSelected=!1}));var n=new e.Views.FluidDroparound({appContext:this.appContext,preferBottom:!0,popBeforePushOther:!0,classList:"sub-photo-additional-info-droparound",anchorElement:this.get("container").one(".meta-permissions-button").one(".arrow"),menuItems:i});n.show(),this.registerEventHandler(n.on("selected",(function(e){e&&e.menuItem&&(t.get("container").one(".meta-permissions-text").set("text",e.menuItem.text),t.setAddMetaPermission(e.menuItem.value)),n.close()})),this)},handleSafetyLevelClick:function(){var t=this,i=this.safetyLevelMenuItems;this.get("photo").getValue("isVideo")&&(i=i.filter((function(e){return e.value!==a}))),i.forEach((function(e){e.value===t.get("photo").getValue("safetyLevel")?e.isSelected=!0:e.isSelected=!1}));var n=new e.Views.FluidDroparound({appContext:this.appContext,preferBottom:!0,popBeforePushOther:!0,classList:"sub-photo-additional-info-droparound",anchorElement:this.get("container").one(".safety-level-button").one(".arrow"),menuItems:i,allowClicksOnDisabledItems:!0});n.show(),this.registerEventHandler(n.on("selected",(function(i){if(i&&i.menuItem)if(i.menuItem.disabled){var o=new e.SubscriptionsHelper,a=o.getProLandingPageUrl(o.UTM_SAFETY_UPSELL,{source:t.isMobile?"mobile":"desktop",medium:"ppSettingMenu"});if(i.menuItem.value===s)new e.Views.FluidModal({appContext:t.appContext,subview:new e.Views["confirmation-dialog-view"]({appContext:t.appContext,title:t.intlMessage({intlName:"common.SAFETY_PRIV_SAFE_ERR_TITLE"}),htmlMessage:t.intlHTMLMessage({intlName:"common.SAFETY_PRIV_SAFE_ERR_MSG",helpCenterURL:"https://www.flickrhelp.com/hc/en-us/articles/4404064374164-Set-the-Safety-Levels-of-Your-Flickr-Content-or-Account",upgradeURL:a}),showCancelButton:!1}),hasSubviewConfigRefactor:!0}).show();else new e.Views.FluidModal({appContext:t.appContext,subview:new e.Views["confirmation-dialog-view"]({appContext:t.appContext,title:t.intlMessage({intlName:"common.SAFETY_PRIV_UPSELL_TITLE"}),htmlMessage:t.intlMessage({intlName:"common.SAFETY_PRIV_UPSELL_MSG"}),confirmButtonText:t.intlMessage({intlName:"common.UPGRADE_TO_PRO_BTN"})}),hasSubviewConfigRefactor:!0}).show().on("actionClick",(e=>{window.open(a,"_blank")}))}else t.get("container").one(".safety-level-text").set("text",i.menuItem.text),t.setSafetyLevel(i.menuItem.value);n.close()})),this)},handleContentTypeClick:function(){var t,i=this;(t=this.get("photo").getValue("isVideo")?this.videoContentTypeMenuItems:this.photoContentTypeMenuItems).forEach((function(e){e.value===i.get("photo").getValue("contentType")?e.isSelected=!0:e.isSelected=!1}));var n=new e.Views.FluidDroparound({appContext:this.appContext,preferBottom:!0,popBeforePushOther:!0,classList:"sub-photo-additional-info-droparound",anchorElement:this.get("container").one(".content-type-button").one(".arrow"),menuItems:t});n.show(),this.registerEventHandler(n.on("selected",(function(e){e&&e.menuItem&&(i.get("container").one(".content-type-text").set("text",e.menuItem.text),i.setContentType(e.menuItem.value)),n.close()})),this)},handlePrintPermissionsClick:function(){var t=this,i=t.printPermissionMenuItems,n=t.get("privacy").toJSON();i.forEach((function(e){e.value===n.permPrint?e.isSelected=!0:e.isSelected=!1}));var s=new e.Views.FluidDroparound({appContext:this.appContext,preferBottom:!0,popBeforePushOther:!0,classList:"sub-photo-additional-info-droparound",anchorElement:this.get("container").one(".print-permissions-button").one(".arrow"),menuItems:i});s.show(),this.registerEventHandler(s.on("selected",(function(e){e&&e.menuItem&&(t.get("container").one(".print-permissions-text").set("text",e.menuItem.text),t.setPrintPermission(e.menuItem.value)),s.close()})),this)},onError:function(t){new e.Views.FluidModal({appContext:this.appContext,subview:new e.Views["confirmation-dialog-view"]({appContext:this.appContext,title:this.intlMessage({intlName:"common.OOPS"}),htmlMessage:t,showCancelButton:!1}),hasSubviewConfigRefactor:!0}).show()}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-modal-view","flag-modal-view","license-history-view","subscriptions-helper","privacy-helper","url","hermes-template-sub-photo-additional-info","hermes-template-flag-photo-dialog-content"],optionalRequires:["hermes-core"],optional:["photo-license-view"],langBundles:["common","photo-page-scrappy","settings"]});YUI.add("sub-photo-right-view",(function(e){e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(t){return this.nsid=t.nsid,this.photoId=t.photoId,this.backToURL=t.backToURL,this.isOwner=t.isOwner,this.showGettyWidget=!0,this.geo=t.geo||e.config.flickr.geo,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"photo-charm-exif-scrappy-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:function(){return[this.appContext.adManager.userCanViewPhotoPageSidebar()&&!this.isMobile?"detached-photopage":""]}},"sub-photo-right-stats-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,additionalViewClasses:function(){return[this.appContext.adManager.userCanViewPhotoPageSidebar()&&!this.isMobile?"detached-photopage":""]}},"sub-photo-date-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,additionalViewClasses:function(){return[this.appContext.adManager.userCanViewPhotoPageSidebar()&&!this.isMobile?"detached-photopage":""]}},"photo-license-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"sub-photo-submoola-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return this.isMobile||this.appContext.getViewer().isPro}},"sub-photo-tags-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:[""]},"sub-photo-contexts-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"sub-photo-additional-info-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"getty-widget-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,type:"photoPage",silly:!0,disabled:function(){return!this.appContext.gettyHelper.canShowWidgetType()||this.appContext.adManager.userCanViewPhotoPageSidebar()}}},loadState:function(){return new e.FlickrPromise({photo:this.appContext.getModel("photo-models",this.photoId)}).then((e=>{this.photoModel=e.photo,this.canShowGettyWidget()&&(this.showGettyWidget=!1)}))},buildContainer:function(){return this.setContainerWithTemplate("sub-photo-right",{showGettyWidget:this.showGettyWidget,shouldSeeSidebar:this.appContext.adManager.userCanViewPhotoPageSidebar()&&!this.isMobile}),this},buildErrorContainer:function(){},activate:function(){var e=this;return this.photoModel&&this.registerEventHandler(this.photoModel.on("valuesChanged",(function(t){t.safetyLevel&&e.canShowGettyWidget()}))),this},canShowGettyWidget:function(){var e=this.showGettyWidget;this.appContext.adManager.canShowAd(this.photoModel)&&this.appContext.gettyHelper.canShowWidgetType()?this.showGettyWidget=!0:this.showGettyWidget=!1,this.appContext.adManager.userCanViewPhotoPageSidebar()&&(this.showGettyWidget=!1),e!==this.showGettyWidget&&this.buildContainer()}})}),"@VERSION@",{requires:["flickr-view","hermes-template-sub-photo-right","sub-photo-submoola-view","url-helper"],optional:["photo-charm-exif-scrappy-view","sub-photo-right-stats-view","sub-photo-contexts-view","photo-license-view","sub-photo-date-view","sub-photo-additional-info-view","getty-widget-view"]});YUI.add("hermes-template-sub-photo-keyboard-shortcuts",(function(n,a){var e=n.Template.Handlebars.revive({1:function(n,a,e,l,t){var s,o=null!=a?a:n.nullContext||{},i=n.hooks.helperMissing,c=n.escapeExpression,r=n.lookupProperty||function(n,a){if(Object.prototype.hasOwnProperty.call(n,a))return n[a]};return'\t\t\x3c!--Favorite Shortcut --\x3e\n\t\t<div class="key-container'+(null!=(s=r(e,"if").call(o,null!=a?r(a,"isOwner"):a,{name:"if",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:5,column:27},end:{line:5,column:58}}}))?s:"")+'" '+(null!=(s=r(e,"unless").call(o,null!=a?r(a,"isOwner"):a,{name:"unless",hash:{},fn:n.program(4,t,0),inverse:n.noop,data:t,loc:{start:{line:5,column:60},end:{line:5,column:102}}}))?s:"")+'>\n\t\t\t<span class="favorite-key key">F</span>\n\t\t\t<span class="favorite-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"common.FAVORITE"},data:t,loc:{start:{line:7,column:46},end:{line:7,column:88}}}))+'</span>\n\t\t</div>\n\n\t\t\x3c!--Comment Shortcut --\x3e\n\t\t<div class="key-container'+(null!=(s=r(e,"unless").call(o,null!=a?r(a,"canAddComment"):a,{name:"unless",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:11,column:27},end:{line:11,column:72}}}))?s:"")+'" '+(null!=(s=r(e,"if").call(o,null!=a?r(a,"canAddComment"):a,{name:"if",hash:{},fn:n.program(4,t,0),inverse:n.noop,data:t,loc:{start:{line:11,column:74},end:{line:11,column:114}}}))?s:"")+'>\n\t\t\t<span class="comment-key key">C</span>\n\t\t\t<span class="comment-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.COMMENT"},data:t,loc:{start:{line:13,column:45},end:{line:13,column:98}}}))+"</span>\n\t\t</div>\n"},2:function(n,a,e,l,t){return" disabled"},4:function(n,a,e,l,t){return'tabindex="1"'},6:function(n,a,e,l,t){var s=n.lookupProperty||function(n,a){if(Object.prototype.hasOwnProperty.call(n,a))return n[a]};return'\t\t<div class="key-container" tabindex="1">\n\t\t\t<span class="search-key key">Z</span>\n\t\t\t<span class="search-key-label key-label">'+n.escapeExpression((s(e,"intlMessage")||a&&s(a,"intlMessage")||n.hooks.helperMissing).call(null!=a?a:n.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ZOOM"},data:t,loc:{start:{line:41,column:44},end:{line:41,column:94}}}))+"</span>\n\t\t</div>\n"},8:function(n,a,e,l,t){var s=n.lookupProperty||function(n,a){if(Object.prototype.hasOwnProperty.call(n,a))return n[a]};return'\t\x3c!--Lightbox Shortcut --\x3e\n\t\t<div class="key-container" tabindex="1">\n\t\t\t<span class="search-key key">L</span>\n\t\t\t<span class="search-key-label key-label">'+n.escapeExpression((s(e,"intlHTMLMessage")||a&&s(a,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=a?a:n.nullContext||{},{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.VIEW_IN_LIGHTBOX"},data:t,loc:{start:{line:47,column:44},end:{line:47,column:110}}}))+"</span>\n\t\t</div>\n"},10:function(n,a,e,l,t){var s,o=null!=a?a:n.nullContext||{},i=n.hooks.helperMissing,c=n.escapeExpression,r=n.lookupProperty||function(n,a){if(Object.prototype.hasOwnProperty.call(n,a))return n[a]};return"\n"+(null!=(s=r(e,"if").call(o,null!=a?r(a,"isOwner"):a,{name:"if",hash:{},fn:n.program(11,t,0),inverse:n.program(13,t,0),data:t,loc:{start:{line:59,column:2},end:{line:87,column:9}}}))?s:"")+'\n\t\t\x3c!--Tagging Shortcuts --\x3e\n\t\t<div class="key-container'+(null!=(s=r(e,"unless").call(o,null!=a?r(a,"canAddMeta"):a,{name:"unless",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:90,column:27},end:{line:90,column:69}}}))?s:"")+'" '+(null!=(s=r(e,"if").call(o,null!=a?r(a,"canAddMeta"):a,{name:"if",hash:{},fn:n.program(4,t,0),inverse:n.noop,data:t,loc:{start:{line:90,column:71},end:{line:90,column:108}}}))?s:"")+'>\n\t\t\t<span class="add-tag-key key">T</span>\n\t\t\t<span class="add-tag-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADD_TAG"},data:t,loc:{start:{line:92,column:45},end:{line:92,column:98}}}))+'</span>\n\t\t</div>\n\n\t\t<div class="key-container'+(null!=(s=r(e,"unless").call(o,null!=a?r(a,"canAddMeta"):a,{name:"unless",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:95,column:27},end:{line:95,column:69}}}))?s:"")+'" '+(null!=(s=r(e,"if").call(o,null!=a?r(a,"canAddMeta"):a,{name:"if",hash:{},fn:n.program(4,t,0),inverse:n.noop,data:t,loc:{start:{line:95,column:71},end:{line:95,column:108}}}))?s:"")+'>\n\t\t\t<span class="add-person-key key">P</span>\n\t\t\t<span class="add-person-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADD_PERSON"},data:t,loc:{start:{line:97,column:48},end:{line:97,column:104}}}))+"</span>\n\t\t</div>\n"},11:function(n,a,e,l,t){var s,o=null!=a?a:n.nullContext||{},i=n.hooks.helperMissing,c=n.escapeExpression,r=n.lookupProperty||function(n,a){if(Object.prototype.hasOwnProperty.call(n,a))return n[a]};return'\n\t\t\t\x3c!--Add to Group Shortcut --\x3e\n\t\t\t<div class="key-container'+(null!=(s=r(e,"unless").call(o,null!=a?r(a,"canAddToGroup"):a,{name:"unless",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:62,column:28},end:{line:62,column:73}}}))?s:"")+'" '+(null!=(s=r(e,"if").call(o,null!=a?r(a,"canAddToGroup"):a,{name:"if",hash:{},fn:n.program(4,t,0),inverse:n.noop,data:t,loc:{start:{line:62,column:75},end:{line:62,column:115}}}))?s:"")+'>\n\t\t\t\t<span class="add-to-group-key key">G</span>\n\t\t\t\t<span class="add-to-group-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADD_TO_GROUP"},data:t,loc:{start:{line:64,column:51},end:{line:64,column:109}}}))+'</span>\n\t\t\t</div>\n\n\t\t\t\x3c!--Add to album Shortcut --\x3e\n\t\t\t<div class="key-container'+(null!=(s=r(e,"unless").call(o,null!=a?r(a,"canAddToAlbum"):a,{name:"unless",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:68,column:28},end:{line:68,column:73}}}))?s:"")+'" '+(null!=(s=r(e,"if").call(o,null!=a?r(a,"canAddToAlbum"):a,{name:"if",hash:{},fn:n.program(4,t,0),inverse:n.noop,data:t,loc:{start:{line:68,column:75},end:{line:68,column:115}}}))?s:"")+'>\n\t\t\t\t<span class="add-to-album-key key">A</span>\n\t\t\t\t<span class="add-to-album-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADD_TO_ALBUM"},data:t,loc:{start:{line:70,column:51},end:{line:70,column:109}}}))+"</span>\n\t\t\t</div>\n\n"},13:function(n,a,e,l,t){var s,o=null!=a?a:n.nullContext||{},i=n.hooks.helperMissing,c=n.escapeExpression,r=n.lookupProperty||function(n,a){if(Object.prototype.hasOwnProperty.call(n,a))return n[a]};return'\n\t\t\t\x3c!--Invite to group Shortcut --\x3e\n\t\t\t<div class="key-container'+(null!=(s=r(e,"unless").call(o,null!=a?r(a,"canInviteToGroup"):a,{name:"unless",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:76,column:28},end:{line:76,column:76}}}))?s:"")+'" '+(null!=(s=r(e,"if").call(o,null!=a?r(a,"canInviteToGroup"):a,{name:"if",hash:{},fn:n.program(4,t,0),inverse:n.noop,data:t,loc:{start:{line:76,column:78},end:{line:76,column:121}}}))?s:"")+'>\n\t\t\t\t<span class="add-to-group-key key">G</span>\n\t\t\t\t<span class="add-to-group-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.INVITE_TO_GROUP"},data:t,loc:{start:{line:78,column:51},end:{line:78,column:112}}}))+'</span>\n\t\t\t</div>\n\n\t\t\t\x3c!--Add to gallery Shortcut --\x3e\n\t\t\t<div class="key-container'+(null!=(s=r(e,"unless").call(o,null!=a?r(a,"canAddToGallery"):a,{name:"unless",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:82,column:28},end:{line:82,column:75}}}))?s:"")+'" '+(null!=(s=r(e,"if").call(o,null!=a?r(a,"canAddToGallery"):a,{name:"if",hash:{},fn:n.program(4,t,0),inverse:n.noop,data:t,loc:{start:{line:82,column:77},end:{line:82,column:119}}}))?s:"")+'>\n\t\t\t\t<span class="add-to-album-key key">A</span>\n\t\t\t\t<span class="add-to-album-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADD_TO_GALLERY"},data:t,loc:{start:{line:84,column:51},end:{line:84,column:111}}}))+"</span>\n\t\t\t</div>\n\n"},compiler:[8,">= 4.3.0"],main:function(n,a,e,l,t){var s,o=null!=a?a:n.nullContext||{},i=n.hooks.helperMissing,c=n.escapeExpression,r=n.lookupProperty||function(n,a){if(Object.prototype.hasOwnProperty.call(n,a))return n[a]};return'\n<div class="sub-photo-keyboard-shortcuts" tabindex="1" aria-label="'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.KEYBOARD_SHORTCUTS"},data:t,loc:{start:{line:2,column:67},end:{line:2,column:131}}}))+'">\n'+(null!=(s=r(e,"if").call(o,null!=a?r(a,"signedIn"):a,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:3,column:1},end:{line:15,column:8}}}))?s:"")+'\n\t\x3c!--Search Shortcut --\x3e\n\t<div class="key-container" tabindex="1">\n\t\t<span class="search-key key">S</span>\n\t\t<span class="search-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"common.SEARCH"},data:t,loc:{start:{line:20,column:43},end:{line:20,column:83}}}))+'</span>\n\t</div>\n\n\t\x3c!--Photo Navigation Shortcut --\x3e\n\t<div class="key-container" tabindex="1">\n\t\t<span class="photo-navigation-key-left key"><i class="photo-navigation-key-icon-left" aria-label="'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"common.LEFT_ARROW"},data:t,loc:{start:{line:25,column:100},end:{line:25,column:144}}}))+'"></i></span>\n\t\t<span class="photo-navigation-key-right key"><i class="photo-navigation-key-icon-right" aria-label="'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"common.RIGHT_ARROW"},data:t,loc:{start:{line:26,column:102},end:{line:26,column:147}}}))+'"></i></span>\n\t\t<span class="photo-navigation-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.PHOTO_NAVIGATION"},data:t,loc:{start:{line:27,column:53},end:{line:27,column:115}}}))+'</span>\n\t</div>\n\n\t\x3c!--Thumbnail Navigation Shortcut --\x3e\n\t<div class="key-container" tabindex="1">\n\t\t<span class="thumbnail-navigation-key-left key"> &lt; </span>\n\t\t<span class="thumbnail-navigation-key-right key"> &gt; </span>\n\t\t<span class="thumbnail-navigation-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.THUMBNAIL_NAVIGATION"},data:t,loc:{start:{line:34,column:57},end:{line:34,column:123}}}))+"</span>\n\t</div>\n\n\t\x3c!--Zoom Shortcut --\x3e\n"+(null!=(s=r(e,"if").call(o,null!=a?r(a,"enableZoom"):a,{name:"if",hash:{},fn:n.program(6,t,0),inverse:n.program(8,t,0),data:t,loc:{start:{line:38,column:1},end:{line:49,column:8}}}))?s:"")+'\n\t\x3c!--Back to Context Shortcut --\x3e\n\t<div class="key-container'+(null!=(s=r(e,"unless").call(o,null!=a?r(a,"canGoBackTo"):a,{name:"unless",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:52,column:26},end:{line:52,column:69}}}))?s:"")+'" '+(null!=(s=r(e,"if").call(o,null!=a?r(a,"canGoBackTo"):a,{name:"if",hash:{},fn:n.program(4,t,0),inverse:n.noop,data:t,loc:{start:{line:52,column:71},end:{line:52,column:109}}}))?s:"")+'>\n\t\t<span class="back-to-context-key key">B</span>\n\t\t<span class="back-to-context-key-label key-label">'+c((r(e,"intlMessage")||a&&r(a,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.BACK_TO_CONTEXT"},data:t,loc:{start:{line:54,column:52},end:{line:54,column:113}}}))+"</span>\n\t</div>\n\n"+(null!=(s=r(e,"if").call(o,null!=a?r(a,"signedIn"):a,{name:"if",hash:{},fn:n.program(10,t,0),inverse:n.noop,data:t,loc:{start:{line:57,column:1},end:{line:99,column:8}}}))?s:"")+"</div>\n\n"},useData:!0}),l={};n.Array.each([],(function(a){var e=n.Template.get("hermes/"+a);e&&(l[a]=e)})),n.Template.register("hermes/sub-photo-keyboard-shortcuts",(function(a,t){return(t=t||{}).partials=t.partials?n.merge(l,t.partials):l,e(a,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("sub-photo-keyboard-shortcuts-view",(function(t){t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.nsid=t.nsid,this.photoId=t.photoId,this.backToURL=t.backToURL,this.hideBackToLink=t.hideBackToLink,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var e=this,o=[];return o.push(e.appContext.getModel("photo-models",e.photoId).then((function(t){e.set("photo",t)}))),o.push(e.appContext.getModel("photo-privacy-models",e.photoId).then((function(t){e.set("photoPrivacyModel",t)}))),e.appContext.getViewer().signedIn&&o.push(e.appContext.getModel("person-groups-models",e.appContext.getViewer().nsid).then((function(t){e.set("personGroupsModel",t)}))),t.Promise.all(o)},buildContainer:function(){return this.setContainerWithTemplate("sub-photo-keyboard-shortcuts",{signedIn:this.appContext.getViewer().signedIn,isOwner:this.get("photo").getValue("owner").getValue("isMe"),enableZoom:!0,canAddToAlbum:this.canAddToAlbum(),canAddToGallery:this.canAddToGallery(),canAddToGroup:this.canAddToGroup(),canInviteToGroup:this.canInviteToGroup(),canAddMeta:this.canAddMeta(),canAddComment:this.get("photo").getValue("canComment"),canGoBackTo:!this.hideBackToLink}),this},canAddToGallery:function(){var t=0===this.get("photo").getValue("safetyLevel"),e=this.get("photoPrivacyModel").getValue("isPublic");return t&&e&&this.appContext.getViewer().nsid!==this._params.nsid&&this.appContext.getViewer().signedIn},canAddToAlbum:function(){return this.appContext.getViewer().nsid===this._params.nsid},canAddToGroup:function(){var t=this.appContext.getViewer().nsid,e=this.get("photo").getValue("owner").getValue("id"),o=this.get("personGroupsModel");return e===t&&o&&(this.get("personGroupsModel").getValue("memberCount")>0||this.get("personGroupsModel").getValue("adminCount")>0||this.get("personGroupsModel").getValue("moderatorCount")>0)},canInviteToGroup:function(){var t=this.appContext.getViewer().nsid,e=this.get("photo").getValue("owner").getValue("id"),o=this.get("personGroupsModel");return e!==t&&o&&o.getValue("adminCount")>0},canAddMeta:function(){var t=this.get("photo");return t.getValue("owner")||t.getValue("canAddMeta")},buildErrorContainer:function(){},activate:function(){return this}})}),"@VERSION@",{requires:["flickr-view","hermes-template-sub-photo-keyboard-shortcuts","url-helper"],optional:[],langBundles:["common","photo-page-scrappy"]});YUI.add("sub-photo-view",(function(e){e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.backToURL=e.backToURL,this.geo=e.geo,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"sub-photo-left-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"sub-photo-right-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"sub-photo-keyboard-shortcuts-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("sub-photo"),this},buildErrorContainer:function(){},activate:function(){return this}})}),"@VERSION@",{requires:["flickr-view","hermes-template-sub-photo","url-helper"],optional:["sub-photo-left-view","sub-photo-right-view","sub-photo-keyboard-shortcuts-view"]});YUI.add("hermes-template-moola-sticky-view",(function(n,e){var t=n.Template.Handlebars.revive({1:function(n,e,t,a,l){return"flickr-infolinks-container"},3:function(n,e,t,a,l){var i,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return(null!=(i=n.invokePartial(r(a,"prbd-moola-position"),e,{name:"prbd-moola-position",hash:{upgradeProLink:null!=e?r(e,"upgradeProLink"):e,class:"non-us-sticky",prebidAdUnit:!0,advertisingStitching:null!=e?r(e,"advertisingStitching"):e,upsellFallback:!1,adUnit:null!=(i=null!=e?r(e,"adConfig"):e)?r(i,"adUnit"):i},data:l,indent:"\t\t",helpers:t,partials:a,decorators:n.decorators}))?i:"")+'\t\t<div class="close-button-container">\n\t\t\t<span class="close-ad-button">&times;</span>\n\t\t</div>\n'},compiler:[8,">= 4.3.0"],main:function(n,e,t,a,l){var i,r=null!=e?e:n.nullContext||{},o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="moola-sticky-view-main-container '+(null!=(i=o(t,"unless").call(r,null!=e?o(e,"prebidAdUnit"):e,{name:"unless",hash:{},fn:n.program(1,l,0),inverse:n.noop,data:l,loc:{start:{line:1,column:45},end:{line:1,column:106}}}))?i:"")+'">\n'+(null!=(i=o(t,"if").call(r,null!=e?o(e,"prebidAdUnit"):e,{name:"if",hash:{},fn:n.program(3,l,0),inverse:n.noop,data:l,loc:{start:{line:2,column:1},end:{line:7,column:8}}}))?i:"")+"</div>\n"},usePartial:!0,useData:!0}),a={};n.Array.each(["prbd-moola-position"],(function(e){var t=n.Template.get("hermes/"+e);t&&(a[e]=t)})),n.Template.register("hermes/moola-sticky-view",(function(e,l){return(l=l||{}).partials=l.partials?n.merge(a,l.partials):a,t(e,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-prbd-moola-position"]});